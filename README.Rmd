---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# dominanceanalysis

[![Build Status](https://travis-ci.org/clbustos/dominanceAnalysis.svg?branch=master)](https://travis-ci.org/clbustos/dominanceAnalysis)
[![codecov](https://codecov.io/gh/clbustos/dominanceAnalysis/branch/master/graph/badge.svg)](https://codecov.io/gh/clbustos/dominanceAnalysis)

Dominance Analysis (Azen and Bodescu, 2003, 2006; Azen and Traxel, 2009;Luo and Azen, 2013), for multiple regression models: OLS, GLM and HLM.

Features:

- Provides complete, conditional and general dominance analysis for *lm* (univariate and multivariate), *lmer* and *glm* (family=binomial).
- Covariance / correlation matrixes could be used as input for OLS dominance analysis, using *lmWithCov* and *mlmWithCov*, respectively.
- You could use multiple criteria as fit indexes (useful for HLM).

# Examples

## Linear regression

We could apply dominance analysis directly on data, using lm (see Azen and Bodescu, 2003). 

On attitude data, we could see that complaints dominates completely all others variables, and learning comes second. The other 4 variables doesn't show a consistent pattern for complete and conditional dominance.
```{r}
  library(dominanceanalysis)
  lm.attitude<-lm(rating~.,attitude)
  da.attitude<-dominanceAnalysis(lm.attitude)
  print(da.attitude)
  summary(da.attitude)
```

To evaluate the robustness of our results, we could use bootstrap analysis (Azen and Bodescu, 2006). We could see that complete dominance of complaints over all other variables is fairly robust, but complete dominance of learning isn't. 

```{r, cache=T}
  bda.attitude=bootDominanceAnalysis(lm.attitude, R=100)
  summary(bda.attitude)
```

We could also use only the correlation or covariance matrix. As example, we use ability.cov matrix to show dominance of 5 specific skills over general intelligence. The bigger average contribution is for reading, but we can see on level 1, vocab, that picture and blocks dominates reading. So, reading dominates completely only maze and vocabulary, blocks dominates picture and maze and picture dominates maze. 

```{r}
lmwithcov<-lmWithCov(general~picture+blocks+maze+reading+vocab, ability.cov$cov)
da.cov<-dominanceAnalysis(lmwithcov)
print(da.cov)
summary(da.cov)
```

## Hierarchical Linear Models

For Hierarchical Linear Models using lme4, you should provide a null model (see Luo and Azen, 2013).

Using npk dataset, we could see that using rb.r2.1 and sb.r2.1 index, that shows influence of predictors on individual data, clearly phosphate dominates over potassium and nitrogen, and potassium dominates over nitrogen.  
```{r}
library(lme4)
lmer.npk.1<-lmer(yield~N+P+K+(1|block),npk)
lmer.npk.0<-lmer(yield~1+(1|block),npk)
da.lmer<-dominanceAnalysis(lmer.npk.1,null.model=lmer.npk.0)
print(da.lmer)
summary(da.lmer)
```


## Logistic regression

For logistic regression (experimental), see Azen and Traxel, 2009.

As example, we use the esoph dataset. Looking the report for standard glm summary, we could see that linear effect of each variables are significant, and also quadratic effect of age. But is hard to identify what variable is more important to predict esophageal cancer. 

```{r}
glm.esoph<-glm(cbind(ncases,ncontrols)~agegp+alcgp+tobgp, esoph,family="binomial")
summary(glm.esoph)
```

Using dominance analysis, we could conclude that age and alcohol dominates completely tobacco, and age shows general dominance over alcohol and tobacco 

```{r}
da.esoph<-dominanceAnalysis(glm.esoph)
print(da.esoph)
summary(da.esoph)
```

Using bootstrap analysis, we could see that dominance of age over tobacco and alcohol over tobacco is fairly robust on all levels, but age over alcohol is not easily reproducible and requires more research.
```{r,cache=T}
da.b.esoph<-bootDominanceAnalysis(glm.esoph,R = 200)
summary(da.b.esoph)$r2.m
```

## Installation

You can install the github version of dominanceanalysis from [github](https://github.com/clbustos/dominanceanalysis) with:

``` r
install_github("clbustos/dominanceanalysis")
```

## References

* Budescu, D. V. (1993). Dominance analysis: A new approach to the problem of relative importance of predictors in multiple regression. Psychological Bulletin, 114(3), 542-551. doi:10.1037/0033-2909.114.3.542

* Azen, R., & Budescu, D. V. (2003). The dominance analysis approach for comparing predictors in multiple regression. Psychological Methods, 8(2), 129-148. doi:10.1037/1082-989X.8.2.129

* Azen, R., & Budescu, D. V. (2006). Comparing Predictors in Multivariate Regression Models: An Extension of Dominance Analysis. Journal of Educational and Behavioral Statistics, 31(2), 157-180. doi:10.3102/10769986031002157

* Azen, R., & Traxel, N. (2009). Using Dominance Analysis to Determine Predictor Importance in Logistic Regression. Journal of Educational and Behavioral Statistics, 34(3), 319-347. doi:10.3102/1076998609332754

* Luo, W., & Azen, R. (2012). Determining Predictor Importance in Hierarchical Linear Models Using Dominance Analysis. Journal of Educational and Behavioral Statistics, 38(1), 3-31. doi:10.3102/1076998612458319

